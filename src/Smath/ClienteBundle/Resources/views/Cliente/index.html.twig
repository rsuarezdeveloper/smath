{% extends '::base.html.twig' %}

{% block body -%}

    <div class="row">
        <div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">
            <h1 class="page-title txt-color-blueDark"><!-- PAGE HEADER --><i class="fa-fw fa fa-home"></i> Maestro de Clientes</h1>
        </div>
        <!-- right side of the page with the sparkline graphs -->
    </div>

    <!-- widget grid -->
    <section id="widget-grid" class="">
        <div class="row">
            <!-- NEW WIDGET START -->
            <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <table id="list"></table>
                <div id="pager"></div>
            </article>
            <!-- WIDGET END -->
        </div>
    </section>
    <!-- end widget grid -->
{% endblock %}
{% block javascripts%}
<script>
$(document).ready(function(){
    $('#list').jqGrid({

        url: '{{path('cliente_list')}}',
        datatype: 'json',
        colNames: ['Id', 'Razon Social', 'Tipo Cliente', 'Tipo Doc.', 'Num Doc.', 'Dirección', 'Teléfono', 'Email', 'Activo', ''],
        jsonReader : {
            root: 'rows',
            page: 'page',
            total: 'total',
            records: 'records',
            repeatitems: false,
            //cell: 'row',
            id: 'id'
        },
        colModel: [
            {name:'id', index:'id', jsonmap:'id', key:true, search:false, align:'center', hidden:true},
            {name:'razonSocial', index:'razonSocial', jsonmap:'razonSocial', width:100,  search:true, align:'left'},
            {name:'tipoCliente', index:'tipoCliente', jsonmap:'tipoCliente', width:100,  search:true, align:'left'},
            {name:'tipoDocumento', index:'tipoDocumento', jsonmap:'tipoDocumento', width:50,  align:'left'},
            {name:'numeroDocumento', index:'numeroDocumento', jsonmap:'numeroDocumento', width:80,  align:'left'},
            {name:'direccion', index:'direccion', jsonmap:'direccion', width:100, align:'left'},
            {name:'telefono', index:'telefono', jsonmap:'telefono', width:100},
            {name:'correoElectronico', index:'correoElectronico', jsonmap:'correoElectronico', width:100, align:'left'},
            {name:'estado', index:'estado', jsonmap:'estado', width:30, align:'center', formatter:status},
            {name:'actions', index:'id', jsonmap:'id', width:30, align:'center',search:false, sortable:false, formatter:editar},
        ],
        pager: '#pager',
        rowNum: 25,
        rowList: [25, 50, 100, 150, 200],
        sortname: 'id',
        sortorder: 'desc',
        viewrecords: true,
        gridview: true,
        autowidth: true,
        height: '100%',
        /*loadComplete: function() {
            $('tr.jqgrow:odd').css('background', '#FCF8F4');
        }*/
    });

    $('#list').jqGrid('filterToolbar',{stringResult: true, searchOnEnter: false, defaultSearch: 'cn'});
    
    // formatters && formating
            
    function dateF(cellvalue, options, rowObject){
        return cellvalue.date.toString('yyyy-mm-dd');
    }
    function currency(cellvalue, options, rowObject){
        if(null==cellvalue) cellvalue=0;
        return cellvalue.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
    }

    function status(cellvalue, options, rowObject){
         html = cellvalue ==1 ? '<i class="fa fa-check-square-o" style="color:green"></i>' : "";
        return html;
    }
    function editar(cellvalue, options, rowObject){
        html = '<a href="{{path('cliente_edit',{id:'__id'})}}" role="button" class="btn btn-xs btn-default"><i class="fa fa-pencil"></i></a>'.replace('__id', cellvalue);
        return html;
    }

    // remove classes
    //$(".ui-pg-input").attr("style","width:10px;height:20px");
    $(".ui-pg-input").attr('style','width:20px')
    $(".ui-pg-selbox").attr("style","width:60px; height:20px;");
    $(".ui-jqgrid").removeClass("ui-widget ui-widget-content");
    $(".ui-jqgrid-view").children().removeClass("ui-widget-header ui-state-default");
    //$(".ui-jqgrid-labels, .ui-search-toolbar").children().removeClass("ui-state-default ui-th-column ui-th-ltr");
    //$(".ui-jqgrid-pager").removeClass("ui-state-default");
    $(".ui-jqgrid").removeClass("ui-widget-content");

    // add classes
    $(".ui-jqgrid-htable").addClass("table table-bordered table-hover");
    $(".ui-jqgrid-btable").addClass("table table-bordered table-striped");

    $(".ui-pg-div").removeClass().addClass("btn btn-sm btn-primary");
    $(".ui-icon.ui-icon-plus").removeClass().addClass("fa fa-plus");
    $(".ui-icon.ui-icon-pencil").removeClass().addClass("fa fa-pencil");
    $(".ui-icon.ui-icon-trash").removeClass().addClass("fa fa-trash-o");
    $(".ui-icon.ui-icon-search").removeClass().addClass("fa fa-search");
    $(".ui-icon.ui-icon-refresh").removeClass().addClass("fa fa-refresh");
    $(".ui-icon.ui-icon-disk").removeClass().addClass("fa fa-save").parent(".btn-primary").removeClass("btn-primary").addClass("btn-success");
    $(".ui-icon.ui-icon-cancel").removeClass().addClass("fa fa-times").parent(".btn-primary").removeClass("btn-primary").addClass("btn-danger");

    $(".ui-icon.ui-icon-seek-prev").wrap("<div class='btn btn-sm btn-default'></div>");
    $(".ui-icon.ui-icon-seek-prev").removeClass().addClass("fa fa-backward");

    $(".ui-icon.ui-icon-seek-first").wrap("<div class='btn btn-sm btn-default'></div>");
    $(".ui-icon.ui-icon-seek-first").removeClass().addClass("fa fa-fast-backward");

    $(".ui-icon.ui-icon-seek-next").wrap("<div class='btn btn-sm btn-default'></div>");
    $(".ui-icon.ui-icon-seek-next").removeClass().addClass("fa fa-forward");

    $(".ui-icon.ui-icon-seek-end").wrap("<div class='btn btn-sm btn-default'></div>");
    $(".ui-icon.ui-icon-seek-end").removeClass().addClass("fa fa-fast-forward");
});
</script>
{%endblock%}
